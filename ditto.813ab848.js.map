{"version":3,"sources":["ditto.js"],"names":["$","ditto","content_id","sidebar_id","edit_id","back_to_top_id","loading_id","error_id","search_name","search_results_class","fragments_class","fragment_class","highlight_code","sidebar","edit_button","back_to_top_button","searchbar","github_username","github_repo","run","initialize","get","sidebar_file","data","init_searchbar","search","html","marked","selector","replace","keydown","searchbar_listener","addClass","fail","alert","show","on","animate","scrollTop","base_url","hash","location","index","window","open","hljs","initHighlightingOnLoad","router","build_text_matches_html","fragments","i","length","fragment","text","display_search_results","results_html","items","hide_errors","build_result_matches_html","matches","url","path","origin","text_matches","show_error","click","destination","event","which","q","val","replace_symbols","li_create_linkage","li_tag","header_level","html_safe_tag","attr","header","offset","top","original_color","css","color","create_youtube_embeds","token_regex","yt_embed_url","youtube_url_to_embed","youtube_url_extract","yt_regex","yt_url","String","match","embed_html","normalize_paths","find","map","src","slice","base_dir","split","join","err_msg","hide","stop_loading","clearInterval","loading_interval","page_getter","scrollTo","pathname","pop","setInterval","fadeIn","fadeOut","compile_into_dom","cb","unescape_html","string","ignore_list","host","inArray","create_page_anchors","headers","push","j","each","block","highlightBlock","escape_html","MathJax","Extension","startNumber","labels","content","document","getElementById","Hub","Queue","console","error","setTimeout","github_search","query","github_api","ajax","Accept","done"],"mappings":"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","file":"ditto.813ab848.js","sourceRoot":"..","sourcesContent":["$(function ($) {\n\n    var ditto = {\n        content_id: $(\"#content\"),\n        sidebar_id: $(\"#sidebar\"),\n\n        edit_id: $(\"#edit\"),\n        back_to_top_id: $(\"#back_to_top\"),\n\n        loading_id: $(\"#loading\"),\n        error_id: $(\"#error\"),\n\n        search_name: $(\"#search\"),\n        search_results_class: \".search_results\",\n        fragments_class: \".fragments\",\n        fragment_class: \".fragment\",\n\n        highlight_code: true,\n\n        // display elements\n        sidebar: true,\n        edit_button: true,\n        back_to_top_button: true,\n        searchbar: true,\n\n        // github specifics\n        github_username: null,\n        github_repo: null,\n\n        // initialize function\n        run: initialize\n    };\n\n    function initialize() {\n        // initialize sidebar and buttons\n        if (ditto.sidebar) {\n            init_sidebar_section();\n        }\n\n        if (ditto.back_to_top_button) {\n            init_back_to_top_button();\n        }\n\n        if (ditto.edit_button) {\n            init_edit_button();\n        }\n\n        // intialize highligh.js\n        if (ditto.highlight_code) {\n            hljs.initHighlightingOnLoad();\n        }\n\n        // page router\n        router();\n        $(window).on('hashchange', router);\n    }\n\n    function init_sidebar_section() {\n        $.get(ditto.sidebar_file, function (data) {\n            ditto.sidebar_id.html(marked(data));\n\n            if (ditto.searchbar) {\n                init_searchbar();\n            }\n\n//由于当作bootstrap导航栏,所以给sidebar中的ul增加class为\"navbar-nav\"\n            // $(\"#sidebar > ul\").addClass(\"navbar-nav\")\n            // $(\"#sidebar > h1\").addClass(\"nav-item\")\n            // $(\"#sidebar > p\").addClass(\"nav-item\")\n            // $(\"#sidebar > p>a\").addClass(\"nav-link\")\n            // $(\"#sidebar > h2\").addClass(\"nav-item\")\n            // $(\"#sidebar > li\").addClass(\"nav-item\")\n            // $(\"#sidebar > a\").addClass(\"nav-link\")\n            // $(\"#sidebar >ul> li\").addClass(\"nav-item\")\n            // // nav-item navbar-nav nav-link\n            // $(\"#sidebar > ol\").addClass(\"navbar-nav\")\n            // $(\"#sidebar >ol> li\").addClass(\"nav-item\")\n            // $(\"#sidebar >ol>li> a\").addClass(\"nav-link\")\n            // $(\"#sidebar >ul>li> a\").addClass(\"nav-link\")\n            // $(\"#sidebar >h1> a\").addClass(\"nav-link\")\n            // $(\"#sidebar >ul>li> input\").addClass(\"nav-link\")\n            $(\"#sidebar  ul\").addClass(\"navbar-nav\")\n$(\"#sidebar  h1\").addClass(\"nav-item\")\n$(\"#sidebar  p\").addClass(\"nav-item\")\n$(\"#sidebar a\").addClass(\"nav-link\")\n$(\"#sidebar  h2\").addClass(\"nav-item\")\n$(\"#sidebar  li\").addClass(\"nav-item\")\n// $(\"#sidebar > a\").addClass(\"nav-link\")\n// $(\"#sidebar >ul> li\").addClass(\"nav-item\")\n// nav-item navbar-nav nav-link\n$(\"#sidebar  ol\").addClass(\"navbar-nav\")\n$(\"#sidebar  li\").addClass(\"nav-item\")\n// $(\"#sidebar >ol>li> a\").addClass(\"nav-link\")\n// $(\"#sidebar >ul>li> a\").addClass(\"nav-link\")\n// $(\"#sidebar >h1> a\").addClass(\"nav-link\")\n$(\"#sidebar  input\").addClass(\"nav-link\")\n        }, \"text\").fail(function () {\n            alert(\"Opps! can't find the sidebar file to display!\");\n        });\n\n    }\n\n    function init_back_to_top_button() {\n        ditto.back_to_top_id.show();\n        ditto.back_to_top_id.on(\"click\", function () {\n            $(\"body, html\").animate({\n                scrollTop: 0\n            }, 200);\n        });\n    }\n\n    function init_edit_button() {\n        if (ditto.base_url === null) {\n            alert(\"Error! You didn't set 'base_url' when calling ditto.run()!\");\n\n        } else {\n            ditto.edit_id.show();\n            ditto.edit_id.on(\"click\", function () {\n                var hash = location.hash.replace(\"#\", \"/\");\n\n                if (hash === \"\") {\n                    hash = \"/\" + ditto.index.replace(\".md\", \"\");\n                }\n\n                window.open(ditto.base_url + hash + \".md\");\n                // open is better than redirecting, as the previous page history\n                // with redirect is a bit messed up\n            });\n        }\n    }\n\n    function init_searchbar() {\n        var sidebar = ditto.sidebar_id.html();\n        var match = \"[ditto:searchbar]\";\n\n        // html input searchbar\n        var search = \"<input name='\" + ditto.search_name.selector + \"'\";\n        search = search + \" type='search'\";\n        search = search + \" results='10'>\";\n\n        // replace match code with a real html input search bar\n        sidebar = sidebar.replace(match, search);\n        ditto.sidebar_id.html(sidebar);\n\n        // add search listener\n        $(\"input[name=\" + ditto.search_name.selector + \"]\").keydown(searchbar_listener);\n    }\n\n    function build_text_matches_html(fragments) {\n        var html = \"\";\n        var class_name = ditto.fragments_class.replace(\".\", \"\");\n\n        html += \"<ul class='\" + class_name + \"'>\";\n        for (var i = 0; i < fragments.length; i++) {\n            var fragment = fragments[i].fragment.replace(\"/[\\uE000-\\uF8FF]/g\", \"\");\n            html += \"<li class='\" + ditto.fragment_class.replace(\".\", \"\") + \"'>\";\n            html += \"<pre><code> \";\n            fragment = $(\"#hide\").text(fragment).html();\n            html += fragment;\n            html += \" </code></pre></li>\";\n        }\n        html += \"</ul>\";\n\n        return html;\n    }\n\n    function build_result_matches_html(matches) {\n        var html = \"\";\n        var class_name = ditto.search_results_class.replace(\".\", \"\");\n\n        html += \"<ul class='\" + class_name + \"'>\";\n        for (var i = 0; i < matches.length; i++) {\n            var url = matches[i].path;\n\n            if (url !== ditto.sidebar_file) {\n                var hash = \"#\" + url.replace(\".md\", \"\");\n                var path = window.location.origin + \"/\" + hash;\n\n                // html += \"<li>\";\n                html += \"<li class='link'>\";\n                html += url;\n                // html += \"<a href='\" + path +\"'>\" + url + \"</a>\";\n                html += \"</li>\";\n\n                var match = build_text_matches_html(matches[i].text_matches);\n                html += match;\n            }\n\n        }\n        html += \"</ul>\";\n\n        return html;\n    }\n\n    function display_search_results(data) {\n        var results_html = \"<h1>Search Results</h1>\";\n\n        if (data.items.length) {\n            hide_errors();\n            results_html += build_result_matches_html(data.items);\n        } else {\n            show_error(\"Opps.. Found no matches!\");\n        }\n\n        ditto.content_id.html(results_html);\n        $(ditto.search_results_class + \" .link\").click(function () {\n            var destination = \"#\" + $(this).html().replace(\".md\", \"\");\n            location.hash = destination;\n        });\n    }\n\n    function github_search(query) {\n        if (ditto.github_username && ditto.github_repo) {\n            // build github search api url string\n            var github_api = \"https://api.github.com/\";\n            var search = \"search/code?q=\";\n            var github_repo = ditto.github_username + \"/\" + ditto.github_repo;\n            var search_details = \"+in:file+language:markdown+repo:\";\n\n            var url = github_api + search + query + search_details + github_repo;\n            var accept_header = \"application/vnd.github.v3.text-match+json\";\n\n            $.ajax(url, { headers: { Accept: accept_header } }).done(function (data) {\n                display_search_results(data);\n            });\n        }\n\n        if (ditto.github_username == null && ditto.github_repo == null) {\n            alert(\"You have not set ditto.github_username and ditto.github_repo!\");\n        } else if (ditto.github_username == null) {\n            alert(\"You have not set ditto.github_username!\");\n        } else if (ditto.github_repo == null) {\n            alert(\"You have not set ditto.github_repo!\");\n        }\n    }\n\n    function searchbar_listener(event) {\n        if (event.which === 13) {  // when user presses ENTER in search bar\n            var q = $(\"input[name=\" + ditto.search_name.selector + \"]\").val();\n            if (q !== \"\") {\n                location.hash = \"#search=\" + q;\n            } else {\n                alert(\"Error! Empty search query!\");\n            }\n        }\n    }\n\n    function replace_symbols(text) {\n        // replace symbols with underscore\n        return text.replace(/[&\\/\\\\#,+=()$~%.'\":*?<>{}\\ \\]\\[]/g, \"_\");\n    }\n\n    function li_create_linkage(li_tag, header_level) {\n        // add custom id and class attributes\n        html_safe_tag = replace_symbols(li_tag.text());\n        li_tag.attr(\"id\", html_safe_tag);\n        li_tag.attr(\"class\", \"link\");\n\n        // add click listener - on click scroll to relevant header section\n        $(ditto.content_id.selector + \" li#\" + li_tag.attr(\"id\")).click(function () {\n            // scroll to relevant section\n            var header = $(\"h\" + header_level + \".\" + li_tag.attr(\"id\"));\n            $('html, body').animate({\n                scrollTop: header.offset().top\n            }, 200);\n\n            // highlight the relevant section\n            original_color = header.css(\"color\");\n            header.animate({ color: \"#ED1C24\", }, 500, function () {\n                // revert back to orig color\n                $(this).animate({ color: original_color }, 2500);\n            });\n        });\n    }\n\n    function create_page_anchors() {\n        // create page anchors by matching li's to headers\n        // if there is a match, create click listeners\n        // and scroll to relevant sections\n\n        // go through header level 2 and 3\n        for (var i = 2; i <= 4; i++) {\n            // parse all headers\n            var headers = [];\n            $(ditto.content_id.selector + ' h' + i).map(function () {\n                headers.push($(this).text());\n                $(this).addClass(replace_symbols($(this).text()));\n            });\n\n            // parse and set links between li and h2\n            $(ditto.content_id.selector + ' ul li').map(function () {\n                for (var j = 0; j < headers.length; j++) {\n                    if (headers[j] === $(this).text()) {\n                        li_create_linkage($(this), i);\n                    }\n                }\n            });\n        }\n    }\n\n    function youtube_url_extract(data) {\n        var yt_regex = /(https?\\:\\/\\/)?(www\\.youtube\\.com|youtu\\.?be)\\/.+/g;\n        var yt_url = String(data.match(yt_regex));\n        yt_url = yt_url.replace(/]/g, \"\");\n        return yt_url;\n    }\n\n    function youtube_url_to_embed(data) {\n        return data = data.replace(/watch\\?v\\=/g, \"embed/\");\n    }\n\n    function create_youtube_embeds(data) {\n        // replaces [ditto:youtube:<some youtube link>]\n        // with a proper youtube embed iframe\n        var token_regex = /\\[ditto\\:youtube:(https?\\:\\/\\/)?(www\\.youtube\\.com|youtu\\.?be)\\/.+\\]/g;\n        var yt_url = youtube_url_extract(data);\n        var yt_embed_url = youtube_url_to_embed(yt_url);\n\n        // youtube embed html\n        var embed_html = `<div class=\"youtube_video\">\n      <div style=\"position:relative;height:0;padding-bottom:56.25%\">\n        <iframe src=\"<link>?ecver=2\"\n          width=\"640\"\n          height=\"360\"\n          frameborder=\"0\"\n          style=\"position:absolute;width:100%;height:100%;left:0\"\n          allowfullscreen>\n        </iframe>\n      </div>\n    </div>`;\n        embed_html = embed_html.replace(\"<link>\", yt_embed_url);\n\n        // replace match code with youtube video\n        data = data.replace(token_regex, embed_html);\n        return data;\n    }\n\n    function normalize_paths() {\n        // images\n        ditto.content_id.find(\"img\").map(function () {\n            var src = $(this).attr(\"src\").replace(/^\\.\\//, \"\");\n            if ($(this).attr(\"src\").slice(0, 5) !== \"http\") {\n                var url = location.hash.replace(\"#\", \"\");\n\n                // split and extract base dir\n                url = url.split(\"/\");\n                var base_dir = url.slice(0, url.length - 1).join(\"/\");\n\n                // normalize the path (i.e. make it absolute)\n                if (base_dir) {\n                    $(this).attr(\"src\", base_dir + \"/\" + src);\n                } else {\n                    $(this).attr(\"src\", src);\n                }\n            }\n        });\n\n    }\n\n    function show_error(err_msg) {\n        ditto.error_id.html(err_msg);\n        ditto.error_id.show();\n    }\n\n    function hide_errors() {\n        ditto.error_id.hide();\n    }\n\n    function show_loading() {\n        ditto.loading_id.show();\n        ditto.content_id.html(\"\");  // clear content\n\n        // infinite loop until clearInterval() is called on loading\n        ditto.loading_interval = setInterval(function () {\n            ditto.loading_id.fadeIn(1000).fadeOut(1000);\n        }, 2000);\n\n    }\n\n    function stop_loading() {\n        clearInterval(ditto.loading_interval);\n        ditto.loading_id.hide();\n    }\n\n    function escape_github_badges(data) {\n        $(\"img\").map(function () {\n            var ignore_list = [\n                \"travis-ci.com\",\n                \"travis-ci.org\",\n                \"coveralls.io\"\n            ];\n            var src = $(this).attr(\"src\");\n\n            var base_url = src.split(\"/\");\n            var protocol = base_url[0];\n            var host = base_url[2];\n\n            if ($.inArray(host, ignore_list) >= 0) {\n                $(this).attr(\"class\", \"github_badges\");\n            }\n        });\n        return data;\n    }\n\n    function page_getter() {\n        window.scrollTo(0, 0);\n        var path = location.hash.replace(\"#\", \"./\");\n\n        // default page if hash is empty\n        var current_page = location.pathname.split(\"/\").pop();\n        if (current_page === \"index.html\") {\n            path = location.pathname.replace(\"index.html\", ditto.index);\n            normalize_paths();\n\n        } else if (path === \"\") {\n            path = window.location + ditto.index;\n            normalize_paths();\n\n        } else {\n            path = path + \".md\";\n\n        }\n\n        // otherwise get the markdown and render it\n        show_loading();\n        $.get(path, function (data) {\n            compile_into_dom(path, data, function () {\n                // rerender mathjax and reset mathjax equation counter\n                if (MathJax && MathJax.Extension[\"Tex/AMSmath\"]) {\n                    MathJax.Extension[\"TeX/AMSmath\"].startNumber = 0;\n                    MathJax.Extension[\"TeX/AMSmath\"].labels = {};\n\n                    var content = document.getElementById(\"content\");\n                    MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, content]);\n                }\n            });\n        }).fail(function () {\n            console.error(\"Opps! ... File not found!\\n5秒后返回主页\")\n            show_error(\"Opps! ... File not found!\\n5秒后返回主页\");\n            stop_loading();\n            setTimeout(()=>{\n                location.hash=\"#\"\n            },5000)\n        });\n    }\n\n    function escape_html(string) {\n        return string\n            .replace(/\\\\/g, \"&#92;\")\n            .replace(/\\_/g, \"&#95;\");\n    }\n\n    function unescape_html(string) {\n        return string\n            .replace(/&amp;#92;/g, \"\\\\\")\n            .replace(/&amp;#95;/g, \"_\");\n    }\n\n    function compile_into_dom(path, data, cb) {\n        hide_errors();\n\n        data = create_youtube_embeds(data);\n        data = marked(escape_html(data));\n        data = unescape_html(data);\n        ditto.content_id.html(data);\n\n        stop_loading();\n        escape_github_badges(data);\n\n        normalize_paths();\n        create_page_anchors();\n\n        if (ditto.highlight_code) {\n            $('pre code').each(function (i, block) {\n                hljs.highlightBlock(block);\n            });\n        }\n\n        if (cb) {\n            cb(data);\n        }\n    }\n\n    function router() {\n        var hash = location.hash;\n\n        if (hash.slice(1, 7) !== \"search\") {\n            page_getter();\n\n        } else {\n            if (ditto.searchbar) {\n                github_search(hash.replace(\"#search=\", \"\"));\n            }\n\n        }\n    }\n\n    window.ditto = ditto;\n});\n"]}